From 0ce211af3a3ad0b1060b542d0a92a07dab5d2d59 Mon Sep 17 00:00:00 2001
From: Bernd Kuhls <bernd@kuhls.net>
Date: Sat, 23 Aug 2025 18:15:39 +0200
Subject: [PATCH] [mod_av] Add support for FFmpeg 8.0

remove deprecated FF_API_FF_PROFILE_LEVEL:
https://github.com/FFmpeg/FFmpeg/commit/822432769868da325ba03774df1084aa78b9a5a0

Upstream: https://github.com/signalwire/freeswitch/pull/2896

Signed-off-by: Bernd Kuhls <bernd@kuhls.net>
---
 src/mod/applications/mod_av/avcodec.c | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/src/mod/applications/mod_av/avcodec.c b/src/mod/applications/mod_av/avcodec.c
index a9d449b562c..9962b821d53 100644
--- a/src/mod/applications/mod_av/avcodec.c
+++ b/src/mod/applications/mod_av/avcodec.c
@@ -530,7 +530,7 @@ static void init_profile(avcodec_profile_t *aprofile, const char *name)
 	aprofile->decoder_thread_count = avcodec_globals.dec_threads;
 
 	if (!strcasecmp(name, "H264")) {
-		aprofile->ctx.profile = FF_PROFILE_H264_BASELINE;
+		aprofile->ctx.profile = AV_PROFILE_H264_BASELINE;
 		aprofile->ctx.level = 31;
 #ifdef AV_CODEC_FLAG_PSNR
 		aprofile->ctx.flags |= AV_CODEC_FLAG_PSNR;
@@ -2071,7 +2071,7 @@ static void parse_profile(avcodec_profile_t *aprofile, switch_xml_t profile)
 
 	ctx = &aprofile->ctx;
 
-	ctx->profile = FF_PROFILE_H264_BASELINE;
+	ctx->profile = AV_PROFILE_H264_BASELINE;
 	ctx->level = 31;
 
 	for (param = switch_xml_child(profile, "param"); param; param = param->next) {
@@ -2094,11 +2094,11 @@ static void parse_profile(avcodec_profile_t *aprofile, switch_xml_t profile)
 
 			if (ctx->profile == 0 && !strcasecmp(aprofile->name, "H264")) {
 				if (!strcasecmp(value, "baseline")) {
-					ctx->profile = FF_PROFILE_H264_BASELINE;
+					ctx->profile = AV_PROFILE_H264_BASELINE;
 				} else if (!strcasecmp(value, "main")) {
-					ctx->profile = FF_PROFILE_H264_MAIN;
+					ctx->profile = AV_PROFILE_H264_MAIN;
 				} else if (!strcasecmp(value, "high")) {
-					ctx->profile = FF_PROFILE_H264_HIGH;
+					ctx->profile = AV_PROFILE_H264_HIGH;
 				}
 			}
 		} else if (!strcmp(name, "level")) {
